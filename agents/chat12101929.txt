agents/test_oasdk_db_file_io.py

@function_tool 是什么原理？

这个其实就是 Python 装饰器 语法糖，本质等价于：

@function_tool
def list_python_files(...):
    ...

# 等价于：

def list_python_files(...):
    ...
list_python_files = function_tool(list_python_files)


也就是：

你先定义了一个普通函数 list_python_files。

然后把这个函数对象传给 function_tool 这个函数。

function_tool(...) 返回一个“包装过的函数对象”，再赋值回 list_python_files 这个名字。

OpenAI Agents SDK 在 function_tool 里做了几件事：

读取原始函数的名字、参数类型注解、docstring，生成一个 OpenAI 工具的 JSON 描述（name, parameters 等）。

返回一个“带元数据的包装函数”，既可以当普通 Python 函数调用，又可以被 Agent 当作 tool 来调用。

Runner 在执行时，会：

把这些工具描述发给模型；

当模型产生 tool_call，Runner 用这个包装函数在本地执行；

再把返回值作为 tool 的结果喂回给模型。

所以从你视角看：

你只需要写一个普通函数，加个 @function_tool；

SDK 自动帮你把它注册成 Agent 工具，并负责“模型 ↔ Python 函数”的来回调用。